Diagonal(3)
diag(x = 1, 3, 3)
diag(u_i, 3, 3)
d_p <- 2.1    # mean duration of preclinical infectiousness (days)
d_c <- 2.9    # mean duration of clinical infectiousness (days)
d_s <- 5      # mean duration of subclinical infectiousness (days)
f <- 0.5      # relative infectiousness of subclinical cases
u_i <- 0.078  # susceptibility for age group i (TODO: update so it's a fn of age)
y_i <- 0.5    # probability of clinical infection by age group i (TODO: update so it's a fn of age)
Du <- diag(u_i, rows, rows)
Dy <- diag(y_i, rows, rows)
# From Eames (Davies ref 19)
C <- rbind(c(0.1, 0.3, 6.6, 2.1), c(0.8, 3.8, 14.8, 1), c(1.4, 27.7, 11.2, 1), c(4, 1.8, 7.8, 0.1))
print(C)
dim(C)
dim(C)[1]
rows <- dim(C)[1]
Du <- diag(u_i, rows, rows)
Dy <- diag(y_i, rows, rows)
# Ex contact matrix From Eames (Davies ref 19)
# Age groups: 0-4, 5-18, 19-64, 65+)
C <- rbind(c(0.1, 0.3, 6.6, 2.1), c(0.8, 3.8, 14.8, 1), c(1.4, 27.7, 11.2, 1), c(4, 1.8, 7.8, 0.1))
View(Du)
View(C)
NGM <- (d_p + d_c - f*d_s)*Du*C*Dy + f*d_s*Du*C
View(NGM)
Du*C
Du.*C
Du .* C
Du *.* C
Du .*. C
Du %*% C
X <- rbind(c(1,2), c(3, 4))
Y <- rbind(c(4, 3), c(2, 1))
X %*% Y
NGM <- (d_p + d_c - f*d_s)*Du %*% C %*% Dy + (f*d_s)*Du %*% C
View(NGM)
#### Example without immunity ####
I_0 <- cbind(c(0, 5, 5, 1))
I_0
#### Example without immunity ####
I_0 <- cbind(c(0, 5, 5, 1))
labels <- c("65+", "19-64", "5-18", "0-4")
row.names(I_0) <- labels
View(I_0)
I_1 <- M*I_0
I_1 <- NGM*I_0
I_1 <- NGM %*% I_0
View(I_1)
# Ex contact matrix From Eames (Davies ref 19)
# Age groups: 0-4, 5-18, 19-64, 65+)
C <- rbind(c(0.1, 0.2, 1.6, 0.7), c(0.4, 0.8, 3.3, 0.5), c(0.5, 4.7, 3.3, 0.4), c(1.9, 1.4, 3.7, 0.1))
NGM <- (d_p + d_c - f*d_s)*Du %*% C %*% Dy + (f*d_s)*Du %*% C
#### Example ####
I_0 <- cbind(c(0, 5, 5, 1))
labels <- c("65+", "19-64", "5-18", "0-4")
row.names(I_0) <- labels
# without immunity
I_1 <- NGM %*% I_0
View(I_1)
library("xlsx")
library("tidyverse")
# setwd to file with Prem contact matrices
setwd("~/Vaccine Strategy/Prem_contact_matrices_152_countries")
# choose country of interest and read in the file
country <- "United States of America"
C_byfives <- read.xlsx("MUestimates_all_locations_2.xlsx", country, header = FALSE)
# convert C to 10 year age-groups
l <- length(C_byfives)
C_bytens <- matrix(nrow = l/2, ncol = l/2)
col_count <- 1
for (col in seq(1,l,by = 2)){
row_count <- 1
for (row in seq(1,l, by = 2)){
C_bytens[row_count, col_count] <- C_byfives[row, col] +
C_byfives[row, col + 1] +
C_byfives[row + 1, col] +
C_byfives[row + 1, col + 1]
row_count <- row_count + 1
}
col_count <- col_count + 1
}
colnames(C_bytens) <- c("0-9", "10-19", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79")
# save as .RData
heatmap(C_bytens)
colnames(C_bytens) <- c("00-9", "10-19", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79")
heatmap(C_bytens)
colnames(C_bytens) <- c("00-09", "10-19", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79")
heatmap(C_bytens)
heatmap(C_bytens, NA, NA)
colnames(C_bytens) <- c("0-9", "10-19", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79")
heatmap(C_bytens, NA, NA)
heatmap(C_bytens, NA, NA, xlab = "Age of Individual", ylab = "Age of Contact")
rownames(C_bytens) <- colnames(C_bytens)
heatmap(C_bytens, NA, NA, xlab = "Age of Individual", ylab = "Age of Contact")
View(C_bytens)
