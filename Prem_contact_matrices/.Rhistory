#  C_bytens: Contact matrix with 10 year age bins, with last bin = 70-79
#
# OUTPUT:
# C_new: Same C matrix with new row & col for 80+ age bin
i_lastbin <- dim(C_bytens_all)[1]
C_new <- rbind(C_bytens, C_bytens[i_lastbin,])
C_new <- cbind(C_new, C_bytens[,i_lastbin])
}
C_bytens_all <- add_80bin(C_bytens_all)
# INPUT:
#  C_bytens: Contact matrix with 10 year age bins, with last bin = 70-79
#
# OUTPUT:
# C_new: Same C matrix with new row & col for 80+ age bin
i_lastbin <- dim(C_bytens_all)[1]
C_new <- matrix(nrow = i_lastbin, ncol = i_lastbin)
C_new[1:i_lastbin, 1:i_lastbin] <- C_bytens_all
View(C_new)
View(C_bytens_all)
rm(list = ls())
setwd("~/Vaccine Strategy/Vaccine_Allocation_Project/Prem_contact_matrices_152_countries")
# IMPORT ----
library("xlsx")
library("tidyverse")
# FUNCTION ----
# convert C to 10 year age-groups
convert_bins_5to10 <- function(C_byfives) {
l <- length(C_byfives)
C_bytens <- matrix(nrow = l/2, ncol = l/2)
col_count <- 1
for (col in seq(1,l,by = 2)){
row_count <- 1
for (row in seq(1,l, by = 2)){
C_bytens[row_count, col_count] <- C_byfives[row, col] +
C_byfives[row, col + 1] +
C_byfives[row + 1, col] +
C_byfives[row + 1, col + 1]
row_count <- row_count + 1
}
col_count <- col_count + 1
}
colnames(C_bytens) <- c("0-9", "10-19", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79")
rownames(C_bytens) <- colnames(C_bytens)
C_bytens
}
#* C for all locations (home, work, school & other) ----
C_byfives_all <- read.xlsx("MUestimates_all_locations_2.xlsx", country, header = FALSE)
country <- "United States of America"
#* C for all locations (home, work, school & other) ----
C_byfives_all <- read.xlsx("MUestimates_all_locations_2.xlsx", country, header = FALSE)
C_bytens_all <- convert_bins_5to10(C_byfives_all)
heatmap(C_bytens_all, NA, NA, xlab = "Age of Individual", ylab = "Age of Contact")
C_bytens <- C_bytens_all
# INPUT:
#  C_bytens: Contact matrix with 10 year age bins, with last bin = 70-79
#
# OUTPUT:
# C_new: Same C matrix with new row & col for 80+ age bin
i_lastbin <- dim(C_bytens)[1]
C_new <- matrix(nrow = i_lastbin + 1, ncol = i_lastbin + 1)
C_new[1:i_lastbin, 1:i_lastbin] <- C_bytens_all
View(C_new)
C_new[1:i_lastbin,i_lastbin + 1] <- C_bytens[2:i_lastbin, i_lastbin]
C_new[2:i_lastbin+1,i_lastbin + 1] <- C_bytens[1:i_lastbin, i_lastbin]
C_bytens[1:i_lastbin, i_lastbin]
C_new[2:i_lastbin+1,i_lastbin + 1]
View(C_new)
C_new[2:(i_lastbin+1),i_lastbin + 1]
C_new[2:(i_lastbin+1),i_lastbin + 1] <- C_bytens[1:i_lastbin, i_lastbin]
View(C_new)
C_new[i_lastbin + 1, 2:(i_lastbin+1)] <- C_bytens[i_lastbin, 1:i_lastbin]
C_new[1,i_lastbin + 1] <- C_new[1, i_lastbin]
C_new[i_lastbin + 1, 1] <- C_new[i_lastbin, 1]
heatmap(C_new, NA, NA, xlab = "Age of Individual", ylab = "Age of Contact")
rm(list = ls())
setwd("~/Vaccine Strategy/Vaccine_Allocation_Project/Prem_contact_matrices_152_countries")
# IMPORT ----
library("xlsx")
library("tidyverse")
# FUNCTION ----
# convert C to 10 year age-groups
convert_bins_5to10 <- function(C_byfives) {
l <- length(C_byfives)
C_bytens <- matrix(nrow = l/2, ncol = l/2)
col_count <- 1
for (col in seq(1,l,by = 2)){
row_count <- 1
for (row in seq(1,l, by = 2)){
C_bytens[row_count, col_count] <- C_byfives[row, col] +
C_byfives[row, col + 1] +
C_byfives[row + 1, col] +
C_byfives[row + 1, col + 1]
row_count <- row_count + 1
}
col_count <- col_count + 1
}
colnames(C_bytens) <- c("0-9", "10-19", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79")
rownames(C_bytens) <- colnames(C_bytens)
C_bytens
}
add_80bin <- function(C_bytens){
# INPUT:
#  C_bytens: Contact matrix with 10 year age bins, with last bin = 70-79
#
# OUTPUT:
# C_new: Same C matrix with new row & col for 80+ age bin
i_lastbin <- dim(C_bytens)[1]
C_new <- matrix(nrow = i_lastbin + 1, ncol = i_lastbin + 1)
C_new[1:i_lastbin, 1:i_lastbin] <- C_bytens
C_new[2:(i_lastbin+1),i_lastbin + 1] <- C_bytens[1:i_lastbin, i_lastbin]
C_new[i_lastbin + 1, 2:(i_lastbin+1)] <- C_bytens[i_lastbin, 1:i_lastbin]
C_new[1,i_lastbin + 1] <- C_new[1, i_lastbin]
C_new[i_lastbin + 1, 1] <- C_new[i_lastbin, 1]
colnames(C_new) <- c("0-9", "10-19", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79", "80+")
rownames(C_new) <- colnames(C_new)
C_new
}
country <- "United States of America"
#* C for all locations (home, work, school & other) ----
C_byfives_all <- read.xlsx("MUestimates_all_locations_2.xlsx", country, header = FALSE)
C_bytens_all <- convert_bins_5to10(C_byfives_all)
heatmap(C_bytens_all, NA, NA, xlab = "Age of Individual", ylab = "Age of Contact")
C_bytens_all <- add_80bin(C_bytens_all)
heatmap(C_bytens_all, NA, NA, xlab = "Age of Individual", ylab = "Age of Contact")
View(C_bytens_all)
heatmap(C_bytens_all, NA, NA, xlab = "Age of Individual", ylab = "Age of Contact")
View(T(C_bytens_all))
View(t(C_bytens_all))
seq(9:1)
myseq <- seq(9:1)
C_bytens_all[9:1,]
test <- C_bytens_all[9:1,]
View(test)
test <- as.data.frame(C_bytens_all)
View(test)
test <- as.data.frame(cbind(c("0-9", "10-19", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79", "80+"), C_bytens_all))
View(test)
# TEST
age_col <- c("0-9", "10-19", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79", "80+")
test <- as.data.frame(cbind(c("0-9", "10-19", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79", "80+"), C_bytens_all))
new_df <- test %>%
select(V1, age_col) %>%
gather(key = "age_group", value = "num", -V1)
test <- as.data.frame(cbind(c("0-9", "10-19", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79", "80+"), C_bytens_all))
new_df <- test %>%
select(V1, all_of(age_col)) %>%
gather(key = "age_group", value = "num", -V1)
View(new_df)
ggplot(new_df, aes(age_group, age_group, fill= num)) +
geom_tile()
#visualize
heatmap(t(C_bytens_all), NA, NA, xlab = "Age of Individual", ylab = "Age of Contact")
#visualize
heatmap(t(C_bytens_all), NA, NA, sacle = "none", xlab = "Age of Individual", ylab = "Age of Contact")
#visualize
heatmap(t(C_bytens_all), NA, NA, scale = "none", xlab = "Age of Individual", ylab = "Age of Contact")
#visualize
heatmap(C_bytens_all, NA, NA, scale = "none", xlab = "Age of Individual", ylab = "Age of Contact")
#visualize
heatmap(C_bytens_all, NA, NA, scale = "column", xlab = "Age of Individual", ylab = "Age of Contact")
#visualize
heatmap(C_bytens_all, NA, NA, scale = "row", xlab = "Age of Individual", ylab = "Age of Contact")
#visualize
heatmap(C_bytens_all, NA, NA, scale = "none", xlab = "Age of Individual", ylab = "Age of Contact")
library("RColorBrewer")
#visualize
coul <- colorRampPalette(brewer.pal(8, "PiYG"))(25)
heatmap(C_bytens_all, NA, NA, scale = "none", color = coul, xlab = "Age of Individual", ylab = "Age of Contact")
heatmap(C_bytens_all, NA, NA, scale = "none", col = coul, xlab = "Age of Individual", ylab = "Age of Contact")
coul
view(coul)
#visualize
coul <- colorRampPalette(brewer.pal(8, "RdBu"))(25)
heatmap(C_bytens_all, NA, NA, scale = "none", col = coul, xlab = "Age of Individual", ylab = "Age of Contact")
#visualize
coul <- colorRampPalette(brewer.pal(8, "RdBu"))(50)
heatmap(C_bytens_all, NA, NA, scale = "none", col = coul, xlab = "Age of Individual", ylab = "Age of Contact")
heatmap(C_bytens_all, NA, NA, scale = "col", col = coul, xlab = "Age of Individual", ylab = "Age of Contact")
heatmap(C_bytens_all, NA, NA, scale = "row", col = coul, xlab = "Age of Individual", ylab = "Age of Contact")
heatmap(C_bytens_all, NA, NA, scale = "row", xlab = "Age of Individual", ylab = "Age of Contact")
heatmap(C_bytens_all, NA, NA, scale = "col", xlab = "Age of Individual", ylab = "Age of Contact")
heatmap?
asdf
help heatmap
heatmap(C_bytens_all, NA, NA, xlab = "Age of Individual", ylab = "Age of Contact")
heatmap(C_bytens_all, NA, NA, scale = "row", xlab = "Age of Individual", ylab = "Age of Contact")
heatmap(C_bytens_all, NA, NA, scale = "col", xlab = "Age of Individual", ylab = "Age of Contact")
View(C_bytens_all)
x <- C_bytens_all[2,2]
C_bytens_all[2,2] <- "NA"
View(C_bytens_all)
C_bytens_all[2,2] <- NA
View(C_byfives_all)
View(C_bytens_all)
heatmap(C_bytens_all, NA, NA, scale = "none", xlab = "Age of Individual", ylab = "Age of Contact")
rm(list = ls())
setwd("~/Vaccine Strategy/Vaccine_Allocation_Project/Prem_contact_matrices_152_countries")
# IMPORT ----
library("xlsx")
library("tidyverse")
library("RColorBrewer")
# FUNCTION ----
# convert C to 10 year age-groups
convert_bins_5to10 <- function(C_byfives) {
l <- length(C_byfives)
C_bytens <- matrix(nrow = l/2, ncol = l/2)
col_count <- 1
for (col in seq(1,l,by = 2)){
row_count <- 1
for (row in seq(1,l, by = 2)){
C_bytens[row_count, col_count] <- C_byfives[row, col] +
C_byfives[row, col + 1] +
C_byfives[row + 1, col] +
C_byfives[row + 1, col + 1]
row_count <- row_count + 1
}
col_count <- col_count + 1
}
colnames(C_bytens) <- c("0-9", "10-19", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79")
rownames(C_bytens) <- colnames(C_bytens)
C_bytens
}
add_80bin <- function(C_bytens){
# INPUT:
#  C_bytens: Contact matrix with 10 year age bins, with last bin = 70-79
#
# OUTPUT:
# C_new: Same C matrix with new row & col for 80+ age bin
i_lastbin <- dim(C_bytens)[1]
C_new <- matrix(nrow = i_lastbin + 1, ncol = i_lastbin + 1)
C_new[1:i_lastbin, 1:i_lastbin] <- C_bytens
C_new[2:(i_lastbin+1),i_lastbin + 1] <- C_bytens[1:i_lastbin, i_lastbin]
C_new[i_lastbin + 1, 2:(i_lastbin+1)] <- C_bytens[i_lastbin, 1:i_lastbin]
C_new[1,i_lastbin + 1] <- C_new[1, i_lastbin]
C_new[i_lastbin + 1, 1] <- C_new[i_lastbin, 1]
colnames(C_new) <- c("0-9", "10-19", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79", "80+")
rownames(C_new) <- colnames(C_new)
C_new
}
country <- "United States of America"
# MAKE CONTACT MATRICES ----
# Read in contact matrix
# Convert 5 years age bins to 10 year age bins
# Add 80+ age bin
#* C for all locations (home, work, school & other) ----
C_byfives_all <- read.xlsx("MUestimates_all_locations_2.xlsx", country, header = FALSE)
C_bytens_all <- convert_bins_5to10(C_byfives_all)
C_bytens_all <- add_80bin(C_bytens_all)
heatmap(C_bytens_all, NA, NA, xlab = "Age of Individual", ylab = "Age of Contact")
x <- C_bytens_all[2,2]
C_bytens_all[2,2] <- NA
heatmap(C_bytens_all, NA, NA, scale = "none", xlab = "Age of Individual", ylab = "Age of Contact")
C_bytens_all[2,2] <- x
heatmap(C_bytens_all, NA, NA, scale = "none", xlab = "Age of Individual", ylab = "Age of Contact")
# save as .RData
saveRDS(C_bytens, "C_USA_bytens_80.RData")
# save as .RData
saveRDS(C_bytens_all, "C_USA_bytens_all.RData")
View(C_bytens_all)
View(C_bytens_all)
C_bytens <- C_bytens_all
bin_70 <- dim(C_bytens)[1]
bin_80 <- bin_70 + 1
bin_60 <- bin_70 - 1
C_new <- matrix(nrow = bin_80, ncol = bin_80)
colnames(C_new) <- c("0-9", "10-19", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79", "80+")
rownames(C_new) <- colnames(C_new)
rm(list = ls())
# setwd to file with Prem contact matrices
setwd("~/Vaccine Strategy/Vaccine_Allocation_Project/Prem_contact_matrices_152_countries")
# IMPORT ----
library("xlsx")
library("tidyverse")
library("RColorBrewer")
# FUNCTION ----
# convert C to 10 year age-groups
convert_bins_5to10 <- function(C_byfives) {
l <- length(C_byfives)
C_bytens <- matrix(nrow = l/2, ncol = l/2)
col_count <- 1
for (col in seq(1,l,by = 2)){
row_count <- 1
for (row in seq(1,l, by = 2)){
C_bytens[row_count, col_count] <- C_byfives[row, col] +
C_byfives[row, col + 1] +
C_byfives[row + 1, col] +
C_byfives[row + 1, col + 1]
row_count <- row_count + 1
}
col_count <- col_count + 1
}
colnames(C_bytens) <- c("0-9", "10-19", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79")
rownames(C_bytens) <- colnames(C_bytens)
C_bytens
}
country <- "United States of America"
# MAKE CONTACT MATRICES ----
# Read in contact matrix
# Convert 5 years age bins to 10 year age bins
# Add 80+ age bin
#* C for all locations (home, work, school & other) ----
C_byfives_all <- read.xlsx("MUestimates_all_locations_2.xlsx", country, header = FALSE)
C_bytens_all <- convert_bins_5to10(C_byfives_all)
c_bytens <- C_bytens_all
bin_70 <- dim(C_bytens)[1]
C_bytens <- C_bytens_all
bin_70 <- dim(C_bytens)[1]
bin_80 <- bin_70 + 1
bin_60 <- bin_70 - 1
C_new <- matrix(nrow = bin_80, ncol = bin_80)
colnames(C_new) <- c("0-9", "10-19", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79", "80+")
rownames(C_new) <- colnames(C_new)
# fill rows for 80+ with same data from 70-79
C_new[1:bin_70, 1:bin_70] <- C_bytens
C_new[2:bin_80, bin_80] <- C_bytens[1:bin_70, bin_70]
C_new[bin_80, 2:bin_80] <- C_bytens[bin_70, 1:bin_70]
C_new[1, bin_80] <- C_new[1, bin_70]
C_new[bin_80, 1] <- C_new[bin_70, 1]
temp <- 0.1 * C_new[1:bin_60, bin_80]
temp
sum(temp)
temp2 <- 0.9 * C_new[1:bin_60, bin_80]
temp + temp2
to_decrease <- 0.1 * C_new[1:bin_60, bin_80]
to_increase <- sum(to_decrease)/2
C_new[1:bin_60, bin_80] <- 0.9 * C_new[1:bin_60, bin_80]
to_increase <- sum(to_decrease)/2
C_new[bin_70, bin_80] <- C_new[bin_70, bin_80] + to_increase
C_new[bin_80, bin_80] <- C_new[bin_80, bin_80] + t0_increase
C_new[bin_80, bin_80] <- C_new[bin_80, bin_80] + to_increase
heatmap(C_new, NA, NA, scale = "none", xlab = "Age of Individual", ylab = "Age of Contact")
heatmap(C_new, NA, NA, scale = "row", xlab = "Age of Individual", ylab = "Age of Contact")
# row 80+
to_decrease <- 0.1 * C_new[bin_80, 1:bin_60]
C_new[bin_80, 1:bin_60] <- 0.9 * C_new[bin_80, 1:bin_60]
to_increase <- sum(to_decrease)/2
C_new[bin_80, bin_70] <- C_new[bin_70, bin_80] + to_increase
C_new[bin_80, bin_80] <- C_new[bin_80, bin_80] + to_increase
rm(list = ls())
setwd("~/Vaccine Strategy/Vaccine_Allocation_Project/Prem_contact_matrices_152_countries")
# IMPORT ----
library("xlsx")
library("tidyverse")
library("RColorBrewer")
# FUNCTION ----
# convert C to 10 year age-groups
convert_bins_5to10 <- function(C_byfives) {
l <- length(C_byfives)
C_bytens <- matrix(nrow = l/2, ncol = l/2)
col_count <- 1
for (col in seq(1,l,by = 2)){
row_count <- 1
for (row in seq(1,l, by = 2)){
C_bytens[row_count, col_count] <- C_byfives[row, col] +
C_byfives[row, col + 1] +
C_byfives[row + 1, col] +
C_byfives[row + 1, col + 1]
row_count <- row_count + 1
}
col_count <- col_count + 1
}
colnames(C_bytens) <- c("0-9", "10-19", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79")
rownames(C_bytens) <- colnames(C_bytens)
C_bytens
}
country <- "United States of America"
# MAKE CONTACT MATRICES ----
# Read in contact matrix
# Convert 5 years age bins to 10 year age bins
# Add 80+ age bin
#* C for all locations (home, work, school & other) ----
C_byfives_all <- read.xlsx("MUestimates_all_locations_2.xlsx", country, header = FALSE)
C_bytens_all <- convert_bins_5to10(C_byfives_all)
heatmap(C_bytens_all, NA, NA, xlab = "Age of Individual", ylab = "Age of Contact")
C_bytens <- C_bytens_all
bin_70 <- dim(C_bytens)[1]
bin_80 <- bin_70 + 1
bin_60 <- bin_70 - 1
C_new <- matrix(nrow = bin_80, ncol = bin_80)
colnames(C_new) <- c("0-9", "10-19", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79", "80+")
rownames(C_new) <- colnames(C_new)
# fill rows for 80+ with same data from 70-79
C_new[1:bin_70, 1:bin_70] <- C_bytens
C_new[2:bin_80, bin_80] <- C_bytens[1:bin_70, bin_70]
C_new[bin_80, 2:bin_80] <- C_bytens[bin_70, 1:bin_70]
C_new[1, bin_80] <- C_new[1, bin_70]
C_new[bin_80, 1] <- C_new[bin_70, 1]
# col 80+
to_decrease <- 0.1 * C_new[1:bin_60, bin_80]
C_new[1:bin_60, bin_80] <- 0.9 * C_new[1:bin_60, bin_80]
to_increase <- sum(to_decrease)/2
C_new[bin_70, bin_80] <- C_new[bin_70, bin_80] + to_increase
C_new[bin_80, bin_80] <- C_new[bin_80, bin_80] + to_increase
# row 80+
to_decrease <- 0.1 * C_new[bin_80, 1:bin_60]
C_new[bin_80, 1:bin_60] <- 0.9 * C_new[bin_80, 1:bin_60]
to_increase <- sum(to_decrease)/2
C_new[bin_80, bin_70] <- C_new[bin_80, bin_70] + to_increase
C_new[bin_80, bin_80] <- C_new[bin_80, bin_80] + to_increase
rm(list = ls())
# setwd to file with Prem contact matrices
setwd("~/Vaccine Strategy/Vaccine_Allocation_Project/Prem_contact_matrices_152_countries")
# IMPORT ----
library("xlsx")
library("tidyverse")
library("RColorBrewer")
# FUNCTION ----
# convert C to 10 year age-groups
convert_bins_5to10 <- function(C_byfives) {
l <- length(C_byfives)
C_bytens <- matrix(nrow = l/2, ncol = l/2)
col_count <- 1
for (col in seq(1,l,by = 2)){
row_count <- 1
for (row in seq(1,l, by = 2)){
C_bytens[row_count, col_count] <- C_byfives[row, col] +
C_byfives[row, col + 1] +
C_byfives[row + 1, col] +
C_byfives[row + 1, col + 1]
row_count <- row_count + 1
}
col_count <- col_count + 1
}
colnames(C_bytens) <- c("0-9", "10-19", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79")
rownames(C_bytens) <- colnames(C_bytens)
C_bytens
}
add_80bin <- function(C_bytens){
# INPUT:
#  C_bytens: Contact matrix with 10 year age bins, with last bin = 70-79
#
# OUTPUT:
# C_new: Same C matrix with new row & col for 80+ age bin
bin_70 <- dim(C_bytens)[1]
bin_80 <- bin_70 + 1
bin_60 <- bin_70 - 1
C_new <- matrix(nrow = bin_80, ncol = bin_80)
colnames(C_new) <- c("0-9", "10-19", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79", "80+")
rownames(C_new) <- colnames(C_new)
# fill rows for 80+ with same data from 70-79
C_new[1:bin_70, 1:bin_70] <- C_bytens
C_new[2:bin_80, bin_80] <- C_bytens[1:bin_70, bin_70]
C_new[bin_80, 2:bin_80] <- C_bytens[bin_70, 1:bin_70]
C_new[1, bin_80] <- C_new[1, bin_70]
C_new[bin_80, 1] <- C_new[bin_70, 1]
# Assumption: 80+ have similar (but less) contact rates as 70-79, with increased contact with 70-80+ (long term living facilities)
# Implementation: Decrease contact for bins 0 - 69 for 80+  by 10% then split these contacts between 70-79 & 80+
# col 80+
to_decrease <- 0.1 * C_new[1:bin_60, bin_80]
C_new[1:bin_60, bin_80] <- 0.9 * C_new[1:bin_60, bin_80]
to_increase <- sum(to_decrease)/2
C_new[bin_70, bin_80] <- C_new[bin_70, bin_80] + to_increase
C_new[bin_80, bin_80] <- C_new[bin_80, bin_80] + to_increase
# row 80+
to_decrease <- 0.1 * C_new[bin_80, 1:bin_60]
C_new[bin_80, 1:bin_60] <- 0.9 * C_new[bin_80, 1:bin_60]
to_increase <- sum(to_decrease)/2
C_new[bin_80, bin_70] <- C_new[bin_80, bin_70] + to_increase
C_new[bin_80, bin_80] <- C_new[bin_80, bin_80] + to_increase
}
country <- "United States of America"
#* C for all locations (home, work, school & other) ----
C_byfives_all <- read.xlsx("MUestimates_all_locations_2.xlsx", country, header = FALSE)
C_bytens_all <- convert_bins_5to10(C_byfives_all)
heatmap(C_bytens_all, NA, NA, xlab = "Age of Individual", ylab = "Age of Contact")
C_bytens_all <- add_80bin(C_bytens_all)
heatmap(C_bytens_all, NA, NA, xlab = "Age of Individual", ylab = "Age of Contact")
C_new
add_80bin <- function(C_bytens){
# INPUT:
#  C_bytens: Contact matrix with 10 year age bins, with last bin = 70-79
#
# OUTPUT:
# C_new: Same C matrix with new row & col for 80+ age bin
bin_70 <- dim(C_bytens)[1]
bin_80 <- bin_70 + 1
bin_60 <- bin_70 - 1
C_new <- matrix(nrow = bin_80, ncol = bin_80)
colnames(C_new) <- c("0-9", "10-19", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79", "80+")
rownames(C_new) <- colnames(C_new)
# fill rows for 80+ with same data from 70-79
C_new[1:bin_70, 1:bin_70] <- C_bytens
C_new[2:bin_80, bin_80] <- C_bytens[1:bin_70, bin_70]
C_new[bin_80, 2:bin_80] <- C_bytens[bin_70, 1:bin_70]
C_new[1, bin_80] <- C_new[1, bin_70]
C_new[bin_80, 1] <- C_new[bin_70, 1]
# Assumption: 80+ have similar (but less) contact rates as 70-79, with increased contact with 70-80+ (long term living facilities)
# Implementation: Decrease contact for bins 0 - 69 for 80+  by 10% then split these contacts between 70-79 & 80+
# col 80+
to_decrease <- 0.1 * C_new[1:bin_60, bin_80]
C_new[1:bin_60, bin_80] <- 0.9 * C_new[1:bin_60, bin_80]
to_increase <- sum(to_decrease)/2
C_new[bin_70, bin_80] <- C_new[bin_70, bin_80] + to_increase
C_new[bin_80, bin_80] <- C_new[bin_80, bin_80] + to_increase
# row 80+
to_decrease <- 0.1 * C_new[bin_80, 1:bin_60]
C_new[bin_80, 1:bin_60] <- 0.9 * C_new[bin_80, 1:bin_60]
to_increase <- sum(to_decrease)/2
C_new[bin_80, bin_70] <- C_new[bin_80, bin_70] + to_increase
C_new[bin_80, bin_80] <- C_new[bin_80, bin_80] + to_increase
C_new
}
country <- "United States of America"
#* C for all locations (home, work, school & other) ----
C_byfives_all <- read.xlsx("MUestimates_all_locations_2.xlsx", country, header = FALSE)
C_bytens_all <- convert_bins_5to10(C_byfives_all)
heatmap(C_bytens_all, NA, NA, xlab = "Age of Individual", ylab = "Age of Contact")
C_bytens_all <- add_80bin(C_bytens_all)
heatmap(C_bytens_all, NA, NA, xlab = "Age of Individual", ylab = "Age of Contact")
heatmap(C_bytens_all, NA, NA, scale = "none", xlab = "Age of Individual", ylab = "Age of Contact")
# SAVE FILE as .RData  ----
saveRDS(C_bytens_all, "C_USA_bytens_all.RData")
